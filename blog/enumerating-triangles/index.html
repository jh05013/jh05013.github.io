<!doctype html><html lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#9a9996 name=theme-color><meta content="default-src 'none';font-src 'self';img-src 'self' https: data:;media-src 'self' https:;style-src 'self' 'unsafe-inline';frame-src https://player.vimeo.com https://www.youtube-nocookie.com https://toot.community;base-uri 'none';form-action 'none';connect-src 'self' https://toot.community;script-src 'self' 'self'" http-equiv=content-security-policy><title>삼각형 찾기 - jh05013</title><link href=https://jh05013.github.io/blog/enumerating-triangles/ rel=canonical><link href=https://jh05013.github.io/favicon.png rel=icon type=image/png><link href=https://jh05013.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="jh05013 - RSS Feed" href=https://jh05013.github.io/rss.xml rel=alternate type=application/rss+xml><link title="jh05013 - Atom Feed" href=https://jh05013.github.io/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#6f8396;--contrast-color:#fff}</style><link href=https://jh05013.github.io/style.css rel=stylesheet><link href=https://jh05013.github.io/katex.css rel=stylesheet><link href=https://jh05013.github.io/mods.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://jh05013.github.io/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://jh05013.github.io/syntax-theme-dark.css rel=stylesheet><script defer src=https://jh05013.github.io/closable.js></script><script defer src=https://jh05013.github.io/copy-button.js></script><script defer src=https://jh05013.github.io/katex.min.js></script><script defer src=https://jh05013.github.io/auto-render.min.js></script><script defer src=https://jh05013.github.io/katex-init.js></script><script defer src=https://jh05013.github.io/fuse.js></script><script defer src=https://jh05013.github.io/search-fuse.js></script><script defer src=https://jh05013.github.io/theme-switcher.js></script><meta content=jh05013 property=og:site_name><meta content="삼각형 찾기 - jh05013" property=og:title><meta content=https://jh05013.github.io/blog/enumerating-triangles/ property=og:url><meta property=og:description><meta content=https://jh05013.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://jh05013.github.io> <i class=icon></i>jh05013</a><li class=divider><li><details class=closable><summary>Links</summary> <ul><li><a href=https://jh05013.github.io/about/>About</a><li><a href=https://jh05013.github.io/blog/>Blog</a></ul></details><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=feed><details class=closable><summary class=circle title=Feed><i class=icon></i></summary> <ul><li><a href=https://jh05013.github.io/rss.xml>RSS</a><li><a href=https://jh05013.github.io/atom.xml>Atom</a></ul></details><li id=repo><a class=circle href=https://github.com/jh05013/jh05013.github.io title=Repository> <i class=icon></i> </a></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><main id=main-content><article><div id=heading><p><small> <time datetime=" 2023-10-02T00:00:00+00:00">Published on October 02, 2023</time></small><h1>삼각형 찾기</h1><p><small><span>6 minutes read</span><span> • </span></small><ul class=tags><li><a class=tag href=https://jh05013.github.io/tags/algorithm/>algorithm</a></ul></div><div id=buttons-container><a title="Go to Top" href=#top id=go-to-top><i class=icon></i></a><a title="File an Issue" href=https://github.com/jh05013/jh05013.github.io id=issue><i class=icon></i></a></div><p>단순 그래프의 정점의 개수를 $n$, 간선의 개수를 $m$이라고 합시다. 이 그래프에 있는 삼각형, 즉 길이 3의 사이클을 모두 찾을 수 있을까요?<h1 id=o-frac-nm-w>$O(\frac{nm}{w})$</h1><p>간선 하나 $uv$를 고정하고, 그 간선을 포함하는 삼각형을 찾아봅시다.<p>인접 행렬을 만듭니다. 그러면 $u$와 $v$에 인접한 모든 정점 $a$에 대해 삼각형 $uva$를 찾을 수 있습니다. 인접 행렬의 $u$행과 $v$행에서 둘 다 인접 표시가 된 열을 찾으면 됩니다. 시간 복잡도는 $O(nm)$입니다.<p>이 과정을 비트셋의 교집합 연산으로 최적화하면 시간 복잡도 $O(\frac{nm}{w})$에 모든 삼각형을 찾을 수 있습니다. 64비트 컴퓨터에서 $w = 64$입니다.<h2 id=yeonseubmunje>연습문제</h2><ul><li><a href=https://www.acmicpc.net/problem/20501>BOJ 20501 Facebook</a><li><a href=https://atcoder.jp/contests/abc258/tasks/abc258_g>ABC258 Triangle</a><li><a href=https://www.acmicpc.net/problem/8907>BOJ 8907 네온 사인</a> / <a href=https://www.acmicpc.net/problem/8096>BOJ 8096 Monochromatic Triangles</a>를 말그대로 붉은색, 파란색 삼각형을 직접 세서 풀 수 있습니다.</ul><h1 id=o-m-sqrt-m>$O(m \sqrt m)$</h1><p>정점 $v$의 차수를 $\deg(v)$라고 할 때, 다음 식을 생각해 봅시다.<p>$$\sum_{uv \in E} \min(\deg(u), \deg(v))$$<p>이 값은 $O(m \sqrt m)$입니다.<p><strong>증명.</strong> $\sum_{v \in V} \deg(v) = 2m$이므로, $\deg(v) \geq \sqrt m$인 정점은 많아야 $O(\sqrt m)$개입니다. 그래프가 단순하므로, $\min(\deg(u), \deg(v)) \geq \sqrt m$인 간선은 많아야 $O(m)$개입니다. 나머지 간선은 $\min(\deg(u), \deg(v)) \leq \sqrt m$입니다. ■<p>이제 정점을 차수 순으로, 동점일 경우 번호 순으로 정렬해서 위에서 아래로 늘어놓읍시다. 위 $v$에서 아래 $p$로 가는 간선을 $v \downarrow p$라고 합시다.<p>모든 간선 $v \downarrow p$에 대해 간선 $pq$(위아래 상관없음)를 모두 찾을 수 있습니다. 예를 들면 아래와 같은 경우가 있습니다.<p><img alt="TODO: add subtitle" src=/images/triangle_downpq.png><p>그러한 $(v, p, q)$ 쌍은 $O(\sum_{v \rightarrow p \in E} \deg(p)) = O(m \sqrt m)$개 존재합니다. $\min(\deg(v), \deg(p)) = \deg(p)$이기 때문입니다.<p>따라서, 위에서 아래로 가는 $v \downarrow p \downarrow q$ 꼴의 경로도 당연히 모두 찾을 수 있습니다.<p>이제 각 $v \downarrow p \downarrow q$에 대해 $q$와 $v$가 인접한지 확인하면 됩니다. 간단하게는 해시셋으로 구현할 수 있지만 이는 너무 무겁고, 다음과 같은 방법으로 진행할 수 있습니다.<ul><li>우선 크기 $n$의 배열 $A$를 초기화합니다.<li>각 $v$에 대해… <ul><li>각 간선 $v \downarrow p$에 대해 $A[p]$를 마킹합니다. 즉 $A[p]$는 “$p$가 $v$의 아래에 있으면서 인접하다“라는 뜻입니다.<li>다시 각 간선 $v \downarrow p$에 대해, 간선 $p \downarrow q$들을 순회합니다. $A[q]$가 마킹되어 있다면 삼각형 $vpq$를 찾았습니다.<li>다시 각 간선 $v \downarrow p$에 대해 $A[p]$의 마킹을 지웁니다.</ul></ul><p>각 삼각형은 $a \downarrow b \downarrow c$ 꼴의 경로를 정확히 하나씩 갖고 있으므로, 각 삼각형이 정확히 한 번씩 세어집니다. 총 시간 복잡도는 $O(m \sqrt m)$입니다. 같은 방법으로 그래프에는 삼각형이 최대 $O(m \sqrt m)$개 있음을 증명할 수 있습니다.<h2 id=yeonseubmunje-1>연습문제</h2><ul><li><a href=https://judge.yosupo.jp/problem/enumerate_triangles>LC Enumerate Triangles</a><li><a href=https://www.acmicpc.net/problem/1762>BOJ 1762 평면그래프와 삼각형</a>을 평면그래프 조건 없이 풀 수 있습니다.</ul><h2 id=cuga-yeonseubmunje>추가 연습문제</h2><h3 id=boj-14571-moraesigye-in-o-m-sqrt-m><a href=https://www.acmicpc.net/problem/14571>BOJ 14571 모래시계</a> in $O(m \sqrt m)$</h3><p>모든 삼각형을 $O(m \sqrt m)$에 찾습니다. 각 정점 $v$에 대해, $v$를 포함하는 삼각형 $vpq$에 대해 간선 $pq$의 목록을 저장해 둡니다.<p>모래시계의 중심 $v$를 고정하고, $v$에 대한 간선 $pq$로 이루어진 부분그래프를 생각해 봅시다. 이 부분그래프의 간선 $e$개 중 두 개를 고르되 겹치는 정점이 없도록 하는 경우의 수를 구하면 됩니다. 첫 번째 간선 $ab$를 고르고, 나머지 간선 중 $a$ 또는 $b$와 이어지는 것을 모두 제외하면, 남은 간선의 개수는 $e - \deg(a) - \deg(b) + 1$입니다. 이때 $\deg$는 부분그래프 기준입니다.<p>부분그래프에서 차수를 관리하는 것은 위의 $A$ 배열과 같은 방식으로 진행할 수 있습니다.<h3 id=sagaghyeongyi-gaesu><a href=https://judge.yosupo.jp/problem/counting_c4>사각형의 개수</a></h3><p>삼각형뿐만 아니라 사각형도 셀 수 있습니다! 사각형은 최대 $O(m^2)$개 있을 수 있지만, 개수는 $O(m \sqrt m)$에 구할 수 있습니다.<p>메인 아이디어는 아래 그림과 같습니다. 사각형을 $v \downarrow p \rightarrow q$ 꼴의 경로 두 개로 분할할 수 있으니, 그런 형태의 경로를 세는 것입니다. 각 $v \downarrow p$에 대해, $v$의 아래에 있으면서 $v$와 $p$에 인접한 정점 $q$의 개수를 $k_{vp}$라고 하면, 모든 $\frac{k_{vq}(k_{vq}-1)}{2}$의 합을 구하면 됩니다.<p><img alt="graph with directed edges v->p1, v->p2, v->p3, p1->q, and p3->q going downwards, and p2->q going upwards." src=/images/count_4cycles.png><p>앞에서 보았듯이 $k_{vq} > 0$인 $(v, q)$는 $O(m \sqrt m)$개이고, 0보다 큰 모든 $k_{vq}$를 $O(m \sqrt m)$에 구할 수 있습니다.<p>위 과정을 조금 변형하면 각 정점을 포함하는 사각형의 개수도 셀 수 있습니다.<h3 id=boj-2390><a href=https://www.acmicpc.net/problem/2390>BOJ 2390 ⎐</a></h3><p>제가 이 알고리즘을 배운 계기가 된 문제입니다. 검수하면서 풀이를 고민하다가 “사각형을 $O(M^2)$보다 빠르게 셀 수 없는데 어떻게 ⎐를 셀 수 있지?“라고 생각했는데, 사각형을 $O(M \sqrt M)$에 셀 수 있더라고요…<p>바로 위에서 보았듯이, 각 정점 $v$에 대해 $v$를 포함하는 사각형의 개수를 셉니다. 이제 ⎐에서 차수가 4인 정점을 “⎐의 중심“이라고 하면, 각 정점 $v$에 대해 $v$가 중심인 ⎐의 개수를 셉니다. 사각형의 개수에 $deg(v)-2$를 곱하면 됩니다.<p>모든 $v$에 대해 위 값을 구하고 합하면, 놀랍게도 크기 5의 완전 그래프에서 출력이 60이 나옵니다. 왜냐하면 다음 🪁 모양 케이스를 제외하지 않았기 때문입니다.<p><img alt="undirected graph formed by joining two triangles with a common edge, one endpoint being labeled v and having one more edge sprout out of v." src=/images/kite2390.png><p>🪁를 세기 위해, 각 간선 $pq$에 대해 $pq$를 포함하는 삼각형의 개수를 셉니다. 그 후 각 간선 $pq$에 대해 $pq$가 사각형의 대각선인 🪁의 개수를 세줍니다. 삼각형의 개수를 $k$라고 할 때 $\binom{k}{2} (deg(p)-3) (deg(q)-3)$이 답입니다.<p>참고로 이 ⎐ 문양의 정체는 <a href=https://en.wikipedia.org/wiki/Open_collector>NPN open collector</a>로, 전기회로에서 사용하는 문양입니다.<h3 id=boj-28200-4><a href=https://www.acmicpc.net/problem/28200>BOJ 28200 4</a></h3><p>모든 삼각형을 찾습니다. 각 정점 $v$에 대해, $v$를 포함하는 삼각형 $vpq$에 대해 간선 $pq$의 목록을 저장해 둡니다.<p>한 점 $v$를 고정하고, $v$에 대한 간선 $pq$로 이루어진 부분그래프를 생각해 봅시다. 이 부분그래프에서 삼각형의 개수를 세면 되는데, 대부분의 정점에 대해서는 부분그래프가 작을 것이기 때문에 비트셋으로 풀 수 있습니다. 자세한 내용은 <a href="https://qoj.ac/download.php?type=attachments&id=1212&r=2">에디토리얼</a>을 참조하세요.<h1 id=camjo>참조</h1><ul><li><a href=https://arxiv.org/abs/2303.06090>Paul Burkhardt, David G. Harris, Simple and efficient four-cycle counting on sparse graphs</a></ul></article><hr><nav id=post-nav><a class="post-nav-item post-nav-prev" href=https://jh05013.github.io/blog/wf2021/> <div class=nav-arrow>Previous</div> <span class=post-title>ICPC World Finals 2021 풀이</span> </a><a class="post-nav-item post-nav-next" href=https://jh05013.github.io/blog/wf2022/> <div class=nav-arrow>Next</div> <span class=post-title>ICPC World Finals 2022/23 풀이</span> </a></nav><span class=hidden id=copy-code-text>Copy Code</span><span class=hidden id=search-index>https://jh05013.github.io/search_index.en.json</span><span class=hidden id=more-matches-text>$MATCHES more matches</span></main><footer id=site-footer><nav><ul><li><a href=https://jh05013.github.io/about/>About</a><li><a href=https://jh05013.github.io/blog/>Blog</a></ul></nav><p>© jh05013, 2025<p><small>Powered by <a class="link external" href=https://www.getzola.org>Zola</a> and <a class="link external" href=https://duckquill.daudix.one>Duckquill</a> </small><ul id=socials><li><a rel=" me" href=https://github.com/jh05013 title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a><li><a rel=" me" href=https://bsky.app/profile/jh05013.bsky.social title=Bluesky> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EBluesky%3C/title%3E%3Cpath d='M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8Z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>Bluesky</span> </a></ul></footer>