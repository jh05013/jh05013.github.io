<!doctype html><html lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#9a9996 name=theme-color><meta content="default-src 'none';font-src 'self';img-src 'self' https: data:;media-src 'self' https:;style-src 'self' 'unsafe-inline';frame-src https://player.vimeo.com https://www.youtube-nocookie.com https://toot.community;base-uri 'none';form-action 'none';connect-src 'self' https://toot.community;script-src 'self' 'self'" http-equiv=content-security-policy><title>제1회 논산 코드 페스티벌 풀이 - jh05013</title><link href=https://jh05013.github.io/blog/noncofe/ rel=canonical><link href=https://jh05013.github.io/favicon.png rel=icon type=image/png><link href=https://jh05013.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link title="jh05013 - RSS Feed" href=https://jh05013.github.io/rss.xml rel=alternate type=application/rss+xml><link title="jh05013 - Atom Feed" href=https://jh05013.github.io/atom.xml rel=alternate type=application/atom+xml><style>:root{--accent-color:#6f8396;--contrast-color:#fff}</style><link href=https://jh05013.github.io/style.css rel=stylesheet><link href=https://jh05013.github.io/katex.css rel=stylesheet><link href=https://jh05013.github.io/mods.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://jh05013.github.io/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://jh05013.github.io/syntax-theme-dark.css rel=stylesheet><script defer src=https://jh05013.github.io/closable.js></script><script defer src=https://jh05013.github.io/copy-button.js></script><script defer src=https://jh05013.github.io/katex.min.js></script><script defer src=https://jh05013.github.io/auto-render.min.js></script><script defer src=https://jh05013.github.io/katex-init.js></script><script defer src=https://jh05013.github.io/fuse.js></script><script defer src=https://jh05013.github.io/search-fuse.js></script><script defer src=https://jh05013.github.io/theme-switcher.js></script><meta content=jh05013 property=og:site_name><meta content="제1회 논산 코드 페스티벌 풀이 - jh05013" property=og:title><meta content=https://jh05013.github.io/blog/noncofe/ property=og:url><meta property=og:description><meta content=https://jh05013.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://jh05013.github.io> <i class=icon></i>jh05013</a><li class=divider><li><details class=closable><summary>Links</summary> <ul><li><a href=https://jh05013.github.io/about/>About</a><li><a href=https://jh05013.github.io/blog/>Blog</a></ul></details><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=feed><details class=closable><summary class=circle title=Feed><i class=icon></i></summary> <ul><li><a href=https://jh05013.github.io/rss.xml>RSS</a><li><a href=https://jh05013.github.io/atom.xml>Atom</a></ul></details><li id=repo><a class=circle href=https://github.com/jh05013/jh05013.github.io title=Repository> <i class=icon></i> </a></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search for…" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><main id=main-content><article><div id=heading><p><small> <time datetime=" 2020-04-06T00:00:00+00:00">Published on April 06, 2020</time></small><h1>제1회 논산 코드 페스티벌 풀이</h1><p><small><span>7 minutes read</span><span> • </span></small><ul class=tags><li><a class=tag href=https://jh05013.github.io/tags/ps-solution/>ps-solution</a></ul></div><div id=buttons-container><a title="Go to Top" href=#top id=go-to-top><i class=icon></i></a><a title="File an Issue" href=https://github.com/jh05013/jh05013.github.io id=issue><i class=icon></i></a></div><p><a href=https://www.acmicpc.net/category/detail/2206>https://www.acmicpc.net/category/detail/2206</a><h1 id=18857-jib-ddeonawa-yeolca-tago>18857 집 떠나와 열차 타고</h1><p>선인장의 block-cut tree를 생각해 봤을 때, 정점 1과 N 사이에 있는 경로만 생각해도 충분합니다. 그런 경로만 생각하면 그래프는 대충 이런 형태가 됩니다.<p><img alt src=/images/noncofe1.png><p>이제 1번 정점에서 N번 정점으로 못 가게 하려면, 이 그래프의 BCC 중 하나를 완전히 끊어야 합니다. 완전히 안 끊고 예를 들어 사이클에서 하나의 간선만 제거한다거나 그러면 소용이 없습니다. 따라서, 각각의 BCC를 끊는 비용을 구하고, 그 중 최솟값을 구하면 됩니다.<h1 id=18858-hunryeonsoro-ganeun-nal>18858 훈련소로 가는 날</h1><p>DPu[i][j] = “길이 i, 마지막 정수 j이며, 마지막 두 수가 오름차순인 경우의 수”, DPd[i][j]는 거의 똑같은데 “오름차순이 아닌 경우의 수“로 두면 O(NM^2)가 나옵니다. 이것만으로 시간 내에 돌아가지만, prefix sum을 적절히 사용하여 O(NM)으로 줄일 수도 있습니다.<h1 id=18859-bumonimgge-keunjeol-hago>18859 부모님께 큰절 하고</h1><p>감소수열과 증가수열을 생각하지 말고, 맨 첫 원소를 공유하는 두 개의 증가수열로 분해한다고 생각해 봅시다.<ol><li>맨 첫 원소는 수열의 최솟값이어야 합니다. 그 수를 m이라고 합시다.<li>한 수열의 공차는 (m 제외 최솟값) - m이어야 합니다. 그 공차를 d라고 합시다. d = 0이면 답은 No입니다.<li>m+d에서 시작해서 공차가 d인 등차수열을 적절히 제거했을 때, 남은 수들도 등차수열을 이루어야 합니다.</ol><p>3번은 어떻게 할까요? 수들을 정렬하고, 인접한 수들의 차를 모두 계산했을 때, 그중 최솟값과 최댓값이 같아야만 등차수열을 이룰 수 있습니다. 인접한 수의 차를 모두 저장하는 자료구조를 생각해 봅시다. 여기서 수 x를 지우면, 이런 변화가 일어납니다.<ul><li>x 왼쪽과 오른쪽에 있는 수를 L, R이라고 합시다. L이나 R이 없을 수도 있습니다.<li>L이 있으면, 자료구조에서 L-x가 제거됩니다. R이 있으면, 자료구조에서 x-R이 제거됩니다.<li>그리고 L과 R이 모두 있으면, 자료구조에 R-L이 추가됩니다.</ul><p>따라서 수를 제거, 추가하고, 최솟값과 최댓값을 받아오는 자료구조를 쓰면 됩니다. 가장 대표적인 것으로 multiset이 있고, <a href=https://infossm.github.io/blog/2020/08/16/heap/>임의의 원소 삭제가 가능한 힙</a>을 만들 수도 있습니다.<h1 id=18860-daemun-baggeul-naseol-ddae>18860 대문 밖을 나설 때</h1><p>특정 펌프가 처음으로 작동을 시작한다고 하면, 전체 과정은 이렇게 생각할 수 있습니다.<ol><li>현재 작동 중인 펌프가 포함된 가장 작은 서브트리를 채웁니다.<li>이제 석유가 넘쳐서 더 큰 서브트리로 흘러 가는데, 이 순간에 가능한 한 많은 펌프를 작동시켜야 합니다. x만큼의 석유가 넘치면 min(도달 가능한 펌프 개수, x)개의 펌프를 작동시킬 수 있습니다.<li>그 다음 순간에는 도달 가능한 모든 펌프를 작동시킬 수 있습니다.<li>1번으로 돌아갑니다.</ol><p>2번과 3번은 O(1)에 구현할 수 있습니다. 가장 시간이 오래 걸리는 부분은 1번인데, 채워야 되는 서브트리의 크기를 미리 DP로 계산해 놓으면 이것도 O(1)에 구현할 수 있습니다. 그리고 이 모든 과정은 O(logN)번 반복되므로, 특정 펌프에서 시작할 때 다 채우는 데 걸리는 시간은 O(logN)만에 계산할 수 있습니다.<p>모든 펌프에 대해 시간을 계산하면 됩니다.<h1 id=18861-gaseum-soge-mueosinga>18861 가슴 속에 무엇인가</h1><p>만약 그래프가 포레스트임이 보장된다면, 간선 추가, 삭제, 경로 최솟값을 구하는 쿼리가 됩니다.<p>포레스트가 아니라면 어떨까요? 트리에 간선 하나를 추가해 봅시다. 그러면 사이클이 정확히 하나 만들어집니다. 그 사이클의 간선 중 가중치가 가장 작은 것을 봅시다. (여러 개면 아무거나 선택합니다.) 그러면 그 간선은 더 이상 쓸모가 없습니다. 3번 쿼리의 경우 그 간선을 쓰는 대신 사이클 반대 방향으로 돌아서 가면 되며, 2번 쿼리의 경우 사이클의 다른 간선들이 제거되기 전에 자신이 먼저 제거되기 때문입니다.<p>따라서 새로운 간선을 추가하기 전에, 가중치가 가장 작은 그 간선을 먼저 제거하면, 결과에 영향을 주지 않으면서 포레스트를 유지시킬 수 있습니다. 결국 이것도 경로 최솟값 쿼리가 됩니다. 이 모든 것은 링크-컷 트리로 구현할 수 있습니다. 신난다!<h1 id=18862-aswiumi-namjiman>18862 아쉬움이 남지만</h1><p>EDIT(2022년): 음… 사실 이 글을 네이버 블로그에 2년 전에 썼는데요, 이거랑 그 다음 두 문제는 풀이를 안 썼습니다. 이 문제는 풀이가 정확히 기억나지 않아서 쓰려면 다시 풀어야 합니다…<h1 id=18863-pul-han-pogi-cingu-eolgul>18863 풀 한 포기 친구 얼굴</h1><p>격자의 각 칸마다 (물론 도착점은 제외하고) 어떤 명령을 내릴 수 있는지 판별하면 정점 NM개, 간선 10NM개 이하의 그래프가 만들어집니다. 문제는 출발점에서 유한 개의 간선을 타고 도착점으로 오는 방법의 수를 구하는 것입니다.<p>우선 특정 칸에서 특정 명령을 내릴 수 있는지 판별합시다. 각 명령을 전처리하면서 “이 명령을 수행하는 동안, 명령을 시작한 위치를 기준으로 이동하는 최소/최대 x/y좌표“를 구하면, 특정 칸에서 이 명령을 내릴 때 격자를 벗어나는 경우가 존재하는지 O(1) 만에 판별할 수 있습니다. 예를 들어 명령이 <code>EWN</code>이라면 최소/최대 x좌표는 0과 1, 최소/최대 y좌표는 -1과 0입니다.<p>이제 그래프가 주어졌을 때, (1) 시작점에서 도달할 수 있으면서 (2) 거기서부터 도착점으로 갈 수 있는 칸을 구합니다. 이 두 조건 중 하나라도 만족하지 않는 칸은 욱제가 아예 도달할 수 없거나, 욱제를 (N, M)으로 못 보내서 욱제의 훈련을 끝낼 수 없습니다. (1)은 그대로 그래프 순회를 돌리면 구할 수 있고, (2)는 모든 간선의 방향을 뒤집은 다음 도착점에서 그래프 순회를 돌리면 구할 수 있습니다.<p>이렇게 정점을 쳐낸 후, 그래프에 사이클이 남아있으면 답은 -1이고, 아니면 위상정렬 후 통상적인 DP로 답을 구할 수 있습니다.<h1 id=18864-modeun-geosi-saerobda>18864 모든 것이 새롭다</h1><p>예제 1은 불가능한 퍼즐로 알려진 <a href=https://en.wikipedia.org/wiki/15_puzzle#Solvability>매우 유명한 퍼즐</a>입니다. 왜 불가능할까요?<p>퍼즐의 각 조각마다 그 조각이 (조각이 없을 경우, 빈 칸이) 원래 어디로 와야 되는지를 계산하면, 퍼즐 전체를 하나의 순열로 나타낼 수 있습니다. 조각 하나를 움직이는 것은 조각과 빈 칸을 서로 바꾸는 것이므로 순열에 또 다른 순열 (a b)를 곱하는 것과 같습니다. (a b)는 홀순열이므로, 조각 하나를 움직일 때마다 순열의 홀짝성이 바뀝니다. 그런데 빈 칸이 맨 처음 상태와 마지막 상태에서 위치가 같기 때문에 조각은 짝수 번 움직여야 하고, 따라서 맨 처음 상태와 마지막 상태는 홀짝성이 같습니다. 그런데 실제로는 맨 처음 상태가 홀순열이고, 마지막 상태가 짝순열이기 때문에 이 퍼즐은 맞출 수 없습니다.<p>이를 일반화하면 문제를 풀 수 있습니다. 일단 여섯 차원 중 다섯 개의 크기가 1이면 예외처리를 해야 합니다.<p>이제 맨 처음 상태의 홀짝성을 확인합니다. 마지막 상태는 무조건 짝순열입니다. 따라서 (맨 처음 상태가 홀순열)과 (빈 칸이 홀수 번 움직여야 함)이 동치가 아니면 이 퍼즐은 맞출 수 없습니다. 반대로 동치이면 이 퍼즐은 맞출 수 있는데, 이건 증명하기 조금 까다롭습니다. 한번에 한 레이어씩 맞추면 되던 걸로 기억합니다.<h1 id=18865-ije-dasi-sijagida>18865 이제 다시 시작이다</h1><p>한 스피커에 대해, 볼륨을 점차 증가시키면 훈련소 내부에서 소리가 들리는 영역이 다음과 같이 변합니다.<ol><li>a초까지는 들리는 영역이 없습니다.<li>a초부터 b초까지는 한 변의 길이가 V-a인 직각이등변삼각형이 됩니다.<li>b초부터 c초까지는 한 변의 길이가 V-a인 직각이등변삼각형에서, 위쪽 또는 오른쪽 일부분을 제거한 형태가 됩니다. 단, 둘 중 한 부분만 제거됩니다. b=c일 수도 있습니다.<li>c초부터 d초까지는 위쪽과 오른쪽을 둘 다 제거한 형태가 됩니다.<li>d초부터는 직사각형이 되고 영역이 더 이상 변하지 않습니다.</ol><p><img alt=. src=/images/noncofe2.png><p>이제 영역의 넓이가 어떻게 변하는지 생각해 봅시다. 1번의 경우 따로 해야 될 일이 없습니다. 2번의 경우, a초부터 시작하는 이차함수를 만들 수 있습니다.<p>3번의 경우, V-a 크기의 직각이등변삼각형의 넓이에서 제거된 부분의 넓이를 빼면 됩니다. V-a 삼각형의 넓이는 2번에서 이미 추가되었기 때문에 그대로 쓰면 되고, 제거된 부분은 직각이등변삼각형이므로 이차함수로 나타낼 수 있습니다. 4번도 마찬가지입니다. 5번의 경우 두 “제거된 부분“이 겹친 것이라고 생각할 수 있습니다. 따라서 겹친 부분의 넓이를 다시 더해줘야 합니다. 이 겹친 부분도 직각이등변삼각형이므로 이차함수로 나타낼 수 있습니다.<p>이걸 구현하려면 이런 자료구조가 필요합니다.<ol><li>특정 시간 t부터 정의되는 이차함수를 추가한다.<li>특정 시간 t에서 이차함수들의 합을 구한다.</ol><p>이건 펜윅 트리를 3개 만들어서 풀 수 있습니다. 각 펜윅 트리는 이차함수의 이차항의 계수, 일차항의 계수, 상수항을 각각 저장하면 됩니다.<h1 id=18866-jeolmeun-nalyi-saengiyeo>18866 젊은 날의 생이여</h1><p>1~K년이 젊은 날이 될 수 있는지 판별해 봅시다.<p>먼저, K년까지의 행복도 중 최솟값은 이후의 행복도 중 최댓값보다 커야 합니다. 그걸 판별하려면 행복도 중 누락된 값을 아예 “없는 데이터“로 취급해도 무방합니다. 어차피 K년까지의 행복도 중 누락된 값은 매우 크게 잡아야 하고, 이후의 행복도 중 누락된 값은 매우 낮게 잡아야 하기 때문입니다. 마찬가지로, K년까지의 피로도 중 최댓값이 이후의 피로도 중 최솟값보다 낮아야 합니다.<p>따라서 “첫 x년의 최소 행복도”, “첫 x년의 최대 피로도”, “마지막 x년의 최대 행복도”, “마지막 x년의 최소 피로도“를 모두 구하면 됩니다. DP로 풀 수 있습니다.<h1 id=18867-pyeonji-ggog-haedao>18867 편지 꼭 해다오</h1><p>제한이 많이 널널하기 때문에, 여러 가지 방법으로 풀 수 있습니다.<p>가장 짧은 답안을 찾고 싶다면 냅색을 풀면 됩니다. <code>[a-zA-Z0-9]</code>에 있는 글자만 사용할 때는 5글자가 가장 짧습니다.</article><hr><nav id=post-nav><a class="post-nav-item post-nav-prev" href=https://jh05013.github.io/blog/fenwick-more/> <div class=nav-arrow>Previous</div> <span class=post-title>펜윅 트리 200% 활용하기</span> </a><a class="post-nav-item post-nav-next" href=https://jh05013.github.io/blog/boj20846/> <div class=nav-arrow>Next</div> <span class=post-title>BOJ 20846 수열과 쿼리 40</span> </a></nav><span class=hidden id=copy-code-text>Copy Code</span><span class=hidden id=search-index>https://jh05013.github.io/search_index.en.json</span><span class=hidden id=more-matches-text>$MATCHES more matches</span></main><footer id=site-footer><nav><ul><li><a href=https://jh05013.github.io/about/>About</a><li><a href=https://jh05013.github.io/blog/>Blog</a></ul></nav><p>© jh05013, 2025<p><small>Powered by <a class="link external" href=https://www.getzola.org>Zola</a> and <a class="link external" href=https://duckquill.daudix.one>Duckquill</a> </small><ul id=socials><li><a rel=" me" href=https://github.com/jh05013 title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a><li><a rel=" me" href=https://bsky.app/profile/jh05013.bsky.social title=Bluesky> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EBluesky%3C/title%3E%3Cpath d='M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8Z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>Bluesky</span> </a></ul></footer>